---
title: "Tables for Davis et al (MHQ2)"
author: "Jonathan RI Coleman"
date: "2023-12-21"
output: html_document
---

This is a script containing code to generate tables for the forthcoming decriptive paper for the 2023 mental health follow-up questionnaire.
This requires that the algorithm generating code for the same has already been run.

# Set up

Configure global options for all chunks

```{r Setup, include=FALSE}

knitr::opts_chunk$set(
  echo = TRUE,
  comment = "",
  prompt = FALSE,
  cache = FALSE
)

```

Clear global environment prior to initiation

```{r Clear global environment}

remove(list = ls())

```

# Initialise command line arguments

```{r Initialise command line arguments}

args <- commandArgs(trailingOnly=TRUE)

if(length(args)!=2){
    stop("Please provide full paths to input files containing 1) all fields and 2) all MHQ2 fields", call.=FALSE)
}

```

# Install dependencies

Import package_install function

```{r Define package_install}

package_install <- function(packages) {
  for (x in packages) {
    install.packages(x, dependencies = TRUE)
  }
}

```

```{r Install dependencies - remove hashes to install}

# packages <- c("data.table","tidyverse","dplyr", "Hmisc", "stringi")
# package_install(packages)

```

# Load dependencies

```{r Load dependencies}

packages <- c("data.table", "tidyverse", "dplyr",  "Hmisc", "stringi")
lapply(X = packages, FUN = require, character.only = TRUE)

```

# Read in the data - THIS ASSUMES THE ALGORITHM SCRIPT HAS BEEN RUN!

```{r Read in data}

Full_Data <- fread(args[1], data.table = FALSE)
MHQ2 <- fread(args[2], data.table = FALSE)

```

# Merge Full data with MHQ2 data

```{r Merge data}

MHQ2_Data_Fields_Without_EID <- names(MHQ2)[names(MHQ2) != 'eid']

# Need to check this command works properly...!

Full_Data_No_MHQ2 <- select(Full_Data, -any_of(MHQ2_Data_Fields_Without_EID))

Full_Data_MHQ2 <- full_join(Full_Data_No_MHQ2, MHQ2)

```

# Table 1 - Sample sizes

```{r Table1}

# Completed MHQ2: Marked as having completed all sections
# 29197	When online Mental health questionnaire completed
# 29198	When online Depression questionnaire completed
# 29199	When online Mood changes questionnaire completed
# 29200	When online Anxiety and panic questionnaire completed
# 29201	When online Adverse life events questionnaire completed
# 29202	When online Alcohol use questionnaire completed
# 29203	When online Cannabis use questionnaire completed
# 29204	When online Harm behaviours questionnaire completed
# 29205	When online Eating patterns questionnaire completed
# 29206	When online General health questionnaire completed
# 29207	When online COVID-19 questionnaire completed
# 29208	When online Social situation questionnaire completed
# 29209	When online General well-being questionnaire completed

Full_Data_MHQ2$MHQ2_Completed <- with(Full_Data_MHQ2,
  case_when(
    is.na(`29197-0.0`) | `29197-0.0` < 0 |
      is.na(`29198-0.0`) | `29198-0.0` < 0 |
      is.na(`29199-0.0`) | `29199-0.0` < 0 |
      is.na(`29200-0.0`) | `29200-0.0` < 0 |
      is.na(`29201-0.0`) | `29201-0.0` < 0 |
      is.na(`29202-0.0`) | `29202-0.0` < 0 |
      is.na(`29203-0.0`) | `29203-0.0` < 0 |
      is.na(`29204-0.0`) | `29204-0.0` < 0 |
      is.na(`29205-0.0`) | `29205-0.0` < 0 |
      is.na(`29206-0.0`) | `29206-0.0` < 0 |
      is.na(`29207-0.0`) | `29207-0.0` < 0 |
      is.na(`29208-0.0`) | `29208-0.0` < 0 |
      is.na(`29209-0.0`) | `29209-0.0` < 0 ~ NA_real_,
    .default = 1
  )
)

sink("Table1.txt")

writeLines("Stage Number")
writeLines("UK.Population DEFINED.ELSEWHERE")
writeLines("Invites DEFINED.ELSEWHERE")
writeLines("Started DEFINED.ELSEWHERE")
writeLines(paste0("Completed ", sum(Full_Data_MHQ2$MHQ2_Completed, na.rm=T)))

sink()

```

# Define characteristics for Table 2

This section uses code from the 2016 MHQ paper Davis et al (2020)

Age
  Age is defined as:
    the age at initial assessment centre visit (21003-0.0)
    plus the difference between
      the date of the initial assessment centre visit (53-0.0)
      and the date of the questionnaire (date.field, variable between questionnaires)
  Age for the whole UKB is the age at median completion date of the MHQ2
  Age for MHQ1 subset is the age for each individual when they completed the MHQ1
  Age for MHQ2 subset is the age for each individual when they completed the MHQ2

```{r DefineAge}

## Age

define_age <- function(data, date.field, cohort){

  if(cohort == "UKB"){
    return(
      as.numeric(
        with(data,
          `21003-0.0` +
  	  ceiling(
	    difftime(
              median(as.Date(data[,date.field]), na.rm = TRUE),
	      as.Date(`53-0.0`),
	      units="days"
	    )
	    /365.25
	  )
        )
      )
    )
  }

  else{
    return(
      as.numeric(
        with(data,
          `21003-0.0` +
	  ceiling(
	    difftime(
              as.Date(data[,date.field]),
	      as.Date(`53-0.0`),
	      units="days"
	    )
	    /365.25
	  )
	)
      )
    )
  }

}

# UKB

Full_Data_MHQ2$UKB.Age <- define_age(
  data = Full_Data_MHQ2,
  date.field = "29209-0.0",
  cohort = "UKB"
)

# MHQ1

Full_Data_MHQ2$MHQ1.Age <- define_age(
  data = Full_Data_MHQ2,
  date.field = "20400-0.0",
  cohort = "MHQ1"
)

# MHQ2

Full_Data_MHQ2$MHQ2.Age <- define_age(
  data = Full_Data_MHQ2,
  date.field = "29209-0.0",
  cohort = "MHQ2"
)

# Set individuals answering last section but not all sections to NA.

Full_Data_MHQ2$MHQ2.Age <- ifelse(is.na(Full_Data_MHQ2$MHQ2_Completed) &
  !is.na(Full_Data_MHQ2$`29209-0.0`),
  NA,
  Full_Data_MHQ2$MHQ2.Age
)

## Age bands - derived from Davis et al

define_age_bands <- function(data, age.variable){
  return(
    ordered(
      case_when(is.na(data[,age.variable]) ~ NA_character_,
	data[,age.variable] >= 45 & data[,age.variable] <= 54 ~ "45to54",
	data[,age.variable] >= 55 & data[,age.variable] <= 64 ~ "55to64",
	data[,age.variable] >= 65 & data[,age.variable] <= 74 ~ "65to74",
	data[,age.variable] >= 75 & data[,age.variable] <= 84 ~ "75to84",
	data[,age.variable] >= 85 ~ "85Plus",
	.default = NA_character_
      ),
      levels=c("45to54", "55to64", "65to74", "75to84", "85Plus")
    )
  )
}

# UKB

Full_Data_MHQ2$UKB.Age.Bands <- define_age_bands(
  data = Full_Data_MHQ2,
  age.variable = "UKB.Age"
)

# MHQ1

Full_Data_MHQ2$MHQ1.Age.Bands <- define_age_bands(
  data = Full_Data_MHQ2,
  age.variable = "MHQ1.Age"
)

# MHQ2

Full_Data_MHQ2$MHQ2.Age.Bands <- define_age_bands(
  data = Full_Data_MHQ2,
  age.variable = "MHQ2.Age"
)

## Age median

# UKB

UKB.Age.Median <- median(Full_Data_MHQ2$UKB.Age, na.rm = TRUE)

# MHQ1

MHQ1.Age.Median <- median(Full_Data_MHQ2$MHQ1.Age, na.rm = TRUE)

# MHQ2

MHQ2.Age.Median <- median(Full_Data_MHQ2$MHQ2.Age, na.rm = TRUE)

```

Sex (31-0.0)
  Can be updated by participants, so might reflect self-reported rather than assigned sex in some cases
  UKB is the whole cohort
  MHQ1 is everyone with a valid completion for MHQ1 (20400-0.0)
  MHQ2 is everyone with a valid completion for MHQ2 (MHQ2_Completed)

```{r Sex}

define_sex <- function(data, cohort.identifier){
  return(
    factor(
      x = ifelse(!is.na(data[,cohort.identifier]),
        data[,"31-0.0"],
        NA
      ),
      labels=c("Female","Male")
    )
  )
}

# UKB

Full_Data_MHQ2$UKB.Sex <- define_sex(
  data = Full_Data_MHQ2,
  cohort.identifier = "31-0.0"
)

# MHQ1

Full_Data_MHQ2$MHQ1.Sex <- define_sex(
  data = Full_Data_MHQ2,
  cohort.identifier = "20400-0.0"
)

# MHQ2

Full_Data_MHQ2$MHQ2.Sex <- define_sex(
  data = Full_Data_MHQ2,
  cohort.identifier = "MHQ2_Completed"
)

```

Ethnicity (21000-0.0)
  UKB is the whole cohort
  MHQ1 is everyone with a valid completion for MHQ1 (20400-0.0)
  MHQ2 is everyone with a valid completion for MHQ2 (MHQ2_Completed)

```{r Define ethnicity}

define_ethnicity <- function(data, cohort.identifier){
  return(
    ordered(
      with(data,
        ifelse(!is.na(data[,cohort.identifier]),
          case_when(
            is.na(`21000-0.0`) | `21000-0.0` < 0 ~ NA_character_,
            `21000-0.0` > 1000 & `21000-0.0` < 1999 ~ "White",
  	    `21000-0.0` > 2000 & `21000-0.0` < 2999 ~ "Mixed",
	    `21000-0.0` > 3000 & `21000-0.0` < 3999 ~ "Asian",
	    `21000-0.0` > 4000 & `21000-0.0` < 4999 ~ "Black",
	    `21000-0.0` == 5 ~ "Chinese",
	    `21000-0.0` == 6 ~ "Other",
	    .default = NA_character_
          ),
          NA_character_
        )
      ),
      levels=c("White","Black","Asian","Chinese","Mixed","Other")
    )
  )
}

# UKB

Full_Data_MHQ2$UKB.Ethnicity <- define_ethnicity(
  data = Full_Data_MHQ2,
  cohort.identifier = "21000-0.0"
)

# MHQ1

Full_Data_MHQ2$MHQ1.Ethnicity <- define_ethnicity(
  data = Full_Data_MHQ2,
  cohort.identifier = "20400-0.0"
)

# MHQ2

Full_Data_MHQ2$MHQ2.Ethnicity <- define_ethnicity(
  data = Full_Data_MHQ2,
  cohort.identifier = "MHQ2_Completed"
)

```

Townsend Deprivation Index (189-0.0)
  UKB is the whole cohort
  MHQ1 is everyone with a valid completion for MHQ1 (20400-0.0)
  MHQ2 is everyone with a valid completion for MHQ2 (MHQ2_Completed)

```{r Define TDI}

define_TDI <- function(data, cohort.identifier){
  return(
    ordered(
      with(data,
        ifelse(!is.na(data[,cohort.identifier]),
          case_when(
            is.na(`189-0.0`) ~ NA_character_,
            `189-0.0` >= 2 ~ "Most",
            `189-0.0` < 2 & `189-0.0` > -2 ~ "Average",
            `189-0.0` <= -2 ~ "Least",
            .default = NA_character_
          ),
          NA_character_
        )
      ),
      levels=c("Most","Average","Least")
    )
  )
}

# UKB

Full_Data_MHQ2$UKB.TDI <- define_TDI(
  data = Full_Data_MHQ2,
  cohort.identifier = "189-0.0"
)

# MHQ1

Full_Data_MHQ2$MHQ1.TDI <- define_TDI(
  data = Full_Data_MHQ2,
  cohort.identifier = "20400-0.0"
)

# MHQ2

Full_Data_MHQ2$MHQ2.TDI <- define_TDI(
  data = Full_Data_MHQ2,
  cohort.identifier = "MHQ2_Completed"
)

```

Qualifications (6138-0.0)
  UKB is the whole cohort
  MHQ1 is everyone with a valid completion for MHQ1 (20400-0.0)
  MHQ2 is everyone with a valid completion for MHQ2 (MHQ2_Completed)

```{r Define qualifications}

define_qualifications <- function(data, cohort.identifier){
  return(
    ordered(
      with(data,
        ifelse(!is.na(data[,cohort.identifier]),
          case_when(
            is.na(`6138-0.0`) | ( !is.na(`6138-0.0`) & `6138-0.0` == -3 ) ~ NA_character_,
            `6138-0.0` == -7 ~ "NoneOfTheAbove",
            `6138-0.0` == 1 ~ "Degree",
            `6138-0.0` == 2 ~ "ALevel",
            `6138-0.0` <= 5 ~ "GCSE",
            `6138-0.0` == 6 ~ "Other",
            .default = NA_character_
          ),
          NA_character_
        )
      ),
      levels=c("NoneOfTheAbove", "Other", "GCSE", "ALevel", "Degree")
    )
  )
}

# UKB

Full_Data_MHQ2$UKB.Highest.Qualification <- define_qualifications(
  data = Full_Data_MHQ2,
  cohort.identifier = "6138-0.0"
)

# MHQ1

Full_Data_MHQ2$MHQ1.Highest.Qualification <- define_qualifications(
  data = Full_Data_MHQ2,
  cohort.identifier = "20400-0.0"
)

# MHQ2

Full_Data_MHQ2$MHQ2.Highest.Qualification <- define_qualifications(
  data = Full_Data_MHQ2,
  cohort.identifier = "MHQ2_Completed"
)

```

Housing (680-0.0))
  UKB is the whole cohort
  MHQ1 is everyone with a valid completion for MHQ1 (20400-0.0)
  MHQ2 is everyone with a valid completion for MHQ2 (MHQ2_Completed)
  
```{r Define housing}

define_housing <- function(data, cohort.identifier){
  return(
    ordered(
      with(data,
        ifelse(!is.na(data[,cohort.identifier]),
          case_when(
	    is.na(`680-0.0`) ~ NA_character_,
	    `680-0.0` == 1 ~ "OwnOutright",
	    `680-0.0` == 2 ~ "OwnMortgage",
	    `680-0.0` == 3 ~ "RentSocial",
	    `680-0.0` == 4 ~ "RentPrivate",
	    `680-0.0` > 4 & `680-0.0` == -7 ~ "Other",
            .default = NA_character_
          ),
          NA_character_
        )
      ),
      levels=c("OwnOutright", "OwnMortgage", "RentSocial", "RentPrivate", "Other")
    )
  )
}

# UKB

Full_Data_MHQ2$UKB.Housing <- define_housing(
  data = Full_Data_MHQ2,
  cohort.identifier = "680-0.0"
)

# MHQ1

Full_Data_MHQ2$MHQ1.Housing <- define_housing(
  data = Full_Data_MHQ2,
  cohort.identifier = "20400-0.0"
)

# MHQ2

Full_Data_MHQ2$MHQ2.Housing <- define_housing(
  data = Full_Data_MHQ2,
  cohort.identifier = "MHQ2_Completed"
)

```

Longstanding illness (2188-0.0)
  UKB is the whole cohort
  MHQ1 is everyone with a valid completion for MHQ1 (20400-0.0)
  MHQ2 is everyone with a valid completion for MHQ2 (MHQ2_Completed)
  
```{r Define illness}

define_illness <- function(data, cohort.identifier){
  return(
    with(data,
      ifelse(!is.na(data[,cohort.identifier]),
        ifelse(is.na(`2188-0.0`) | `2188-0.0` < 0,
	  NA_real_,
	  `2188-0.0`
	),
        NA_real_
      )
    )
  )
}

# UKB

Full_Data_MHQ2$UKB.Longstanding.Illness <- define_illness(
  data = Full_Data_MHQ2,
  cohort.identifier = "2188-0.0"
)

# MHQ1

Full_Data_MHQ2$MHQ1.Longstanding.Illness <- define_illness(
  data = Full_Data_MHQ2,
  cohort.identifier = "20400-0.0"
)

# MHQ2

Full_Data_MHQ2$MHQ2.Longstanding.Illness <- define_illness(
  data = Full_Data_MHQ2,
  cohort.identifier = "MHQ2_Completed"
)

```

Neuroticism (20127-0.0)
  UKB is the whole cohort
  MHQ1 is everyone with a valid completion for MHQ1 (20400-0.0)
  MHQ2 is everyone with a valid completion for MHQ2 (MHQ2_Completed)
  
```{r Define neuroticism}

define_neuroticism <- function(data, cohort.identifier){
  return(
    with(data,
      ifelse(!is.na(data[,cohort.identifier]),
        ifelse(is.na(`20127-0.0`) | `20127-0.0` < 0,
	  NA_real_,
	  `20127-0.0`
	),
        NA_real_
      )
    )
  )
}

# UKB

Full_Data_MHQ2$UKB.Neuroticism <- define_neuroticism(
  data = Full_Data_MHQ2,
  cohort.identifier = "20127-0.0"
)

# MHQ1

Full_Data_MHQ2$MHQ1.Neuroticism <- define_neuroticism(
  data = Full_Data_MHQ2,
  cohort.identifier = "20400-0.0"
)

# MHQ2

Full_Data_MHQ2$MHQ2.Neuroticism <- define_neuroticism(
  data = Full_Data_MHQ2,
  cohort.identifier = "MHQ2_Completed"
)

```

Smoking status (20116-0.0)
  UKB is the whole cohort
  MHQ1 is everyone with a valid completion for MHQ1 (20400-0.0)
  MHQ2 is everyone with a valid completion for MHQ2 (MHQ2_Completed)

```{r Define smoking status}

define_smoking <- function(data, cohort.identifier){
  return(
    ordered(
      with(data,
        ifelse(!is.na(data[,cohort.identifier]),
          case_when(
	    is.na(`20116-0.0`) | `20116-0.0` < 0 ~ NA_character_,
            `20116-0.0` == 2 ~ "Current",
            `20116-0.0` == 1 ~ "Former",
            `20116-0.0` == 0 ~ "Never",
            .default = NA_character_
          ),
          NA_character_
        )
      ),
      levels=c("Current", "Former", "Never")
    )
  )
}

# UKB

Full_Data_MHQ2$UKB.Smoking <- define_smoking(
  data = Full_Data_MHQ2,
  cohort.identifier = "20116-0.0"
)

# MHQ1

Full_Data_MHQ2$MHQ1.Smoking <- define_smoking(
  data = Full_Data_MHQ2,
  cohort.identifier = "20400-0.0"
)

# MHQ2

Full_Data_MHQ2$MHQ2.Smoking <- define_smoking(
  data = Full_Data_MHQ2,
  cohort.identifier = "MHQ2_Completed"
)

```

Physical activity (884-0.0)
  UKB is the whole cohort
  MHQ1 is everyone with a valid completion for MHQ1 (20400-0.0)
  MHQ2 is everyone with a valid completion for MHQ2 (MHQ2_Completed)

```{r Define physical activity}

define_physical_activity <- function(data, cohort.identifier){
  return(
    with(data,
      ifelse(!is.na(data[,cohort.identifier]),
        case_when(
	  is.na(`884-0.0`) | `884-0.0` < 0 ~ NA_real_,
	  `884-0.0` > 2 ~ 1,
	  .default = 0
	),
        NA_real_
      )
    )
  )
}

# UKB

Full_Data_MHQ2$UKB.Physical.Activity <- define_physical_activity(
  data = Full_Data_MHQ2,
  cohort.identifier = "884-0.0"
)

# MHQ1

Full_Data_MHQ2$MHQ1.Physical.Activity <- define_physical_activity(
  data = Full_Data_MHQ2,
  cohort.identifier = "20400-0.0"
)

# MHQ2

Full_Data_MHQ2$MHQ2.Physical.Activity <- define_physical_activity(
  data = Full_Data_MHQ2,
  cohort.identifier = "MHQ2_Completed"
)

```

# Table 2 – Sample characteristics

Rows:

Age (10 y bands) + ?median
Sex
Ethnicity (% White)
TDS (% most deprived (>=2))
Highest qual (% degree)
Housing tenure (% rent social or rent private)
Social Factors from baseline
Longstanding illness etc (%) at baseline
Neuroticism score, mean (sd)
Current smoker at baseline
Physical activity at least three times a week

Columns:

MHQ2 new cohort
MHQ1 old cohort
Difference MHQ2 > MHQ1
UKB in general
Difference MHQ2 > UKB

```{r Table 2}

sink("Table2.txt")

## Header
cat("Measure\tSub-measure\tMHQ2\tMHQ1\tMHQ2-MHQ1\tUKB\tMHQ2-UKB\n")

## Age
cat("Age\t45-54\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[1], paste(round(prop.table(table(Full_Data_MHQ2$MHQ2.Age.Bands))[1],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ1.Age.Bands)[1], paste(round(prop.table(table(Full_Data_MHQ2$MHQ1.Age.Bands))[1],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[1] - table(Full_Data_MHQ2$MHQ1.Age.Bands)[1], "\t")
cat(table(Full_Data_MHQ2$UKB.Age.Bands)[1], paste(round(prop.table(table(Full_Data_MHQ2$UKB.Age.Bands))[1],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[1] - table(Full_Data_MHQ2$UKB.Age.Bands)[1], "\n")

cat("Age\t55-64\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[2], paste(round(prop.table(table(Full_Data_MHQ2$MHQ2.Age.Bands))[2],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ1.Age.Bands)[2], paste(round(prop.table(table(Full_Data_MHQ2$MHQ1.Age.Bands))[2],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[2] - table(Full_Data_MHQ2$MHQ1.Age.Bands)[2], "\t")
cat(table(Full_Data_MHQ2$UKB.Age.Bands)[2], paste(round(prop.table(table(Full_Data_MHQ2$UKB.Age.Bands))[2],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[2] - table(Full_Data_MHQ2$UKB.Age.Bands)[2], "\n")

cat("Age\t65-74\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[3], paste(round(prop.table(table(Full_Data_MHQ2$MHQ2.Age.Bands))[3],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ1.Age.Bands)[3], paste(round(prop.table(table(Full_Data_MHQ2$MHQ1.Age.Bands))[3],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[3] - table(Full_Data_MHQ2$MHQ1.Age.Bands)[3], "\t")
cat(table(Full_Data_MHQ2$UKB.Age.Bands)[3], paste(round(prop.table(table(Full_Data_MHQ2$UKB.Age.Bands))[3],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[3] - table(Full_Data_MHQ2$UKB.Age.Bands)[3], "\n")

cat("Age\t75-84\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[4], paste(round(prop.table(table(Full_Data_MHQ2$MHQ2.Age.Bands))[4],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ1.Age.Bands)[4], paste(round(prop.table(table(Full_Data_MHQ2$MHQ1.Age.Bands))[4],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[4] - table(Full_Data_MHQ2$MHQ1.Age.Bands)[4], "\t")
cat(table(Full_Data_MHQ2$UKB.Age.Bands)[4], paste(round(prop.table(table(Full_Data_MHQ2$UKB.Age.Bands))[4],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[4] - table(Full_Data_MHQ2$UKB.Age.Bands)[4], "\n")

cat("Age\t85+\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[5], paste(round(prop.table(table(Full_Data_MHQ2$MHQ2.Age.Bands))[5],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ1.Age.Bands)[5], paste(round(prop.table(table(Full_Data_MHQ2$MHQ1.Age.Bands))[5],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[5] - table(Full_Data_MHQ2$MHQ1.Age.Bands)[5], "\t")
cat(table(Full_Data_MHQ2$UKB.Age.Bands)[5], paste(round(prop.table(table(Full_Data_MHQ2$UKB.Age.Bands))[5],2)*100, "%", sep=""),"\t")
cat(table(Full_Data_MHQ2$MHQ2.Age.Bands)[5] - table(Full_Data_MHQ2$UKB.Age.Bands)[5], "\n")

cat("Age\tMedian","\t")
cat(MHQ2.Age.Median,"\t")
cat(MHQ1.Age.Median,"\t")
cat(MHQ2.Age.Median - MHQ1.Age.Median,"\t")
cat(UKB.Age.Median,"\t")
cat(MHQ2.Age.Median - UKB.Age.Median,"\t")

~TODO~

sink()

```


# Table 3 – Sample characteristics by lifetime disorder
# Supplementary Table 3a – Sample characteristics by lifetime disorder (female sex)
# Supplementary Table 3b – Sample characteristics by lifetime disorder (male sex)

Rows:

Age (10 y bands) + ?median
Sex
Ethnicity (% White)
TDS (% most deprived (>=2))
Highest qual (% degree)
Housing tenure (% rent social or rent private)
Risk factors from baseline only
Neuroticism mean (sd)
Longstanding illness etc (%) at baseline
Current smoker at baseline
Physical activity at least three times a week
Childhood adverse experience
Adult adverse experience
Social isolation
Loneliness from UCLA score
Low resilience from Brief Resilience Score
EQ-5D VAS score mean (sd) (higher is better health)

Columns:

Overall
No lifetime criteria
Depression (MHQ2)
Bipolar type I (MHQ2)
Panic Disorder
Any full threshold eating disorder

# Table 4 - NOT DEFINED

# Figure 5 – Upset plot of disorder overlap

Symptom based outcomes:
depression ever case
bipolar affective disorder type1 case
panic disorder ever case
Anorexia Nervosa ever case
Bulimia nervosa ever case
Purging disorder ever case
Harm to self ever case

### Define MHQ1 Phenotypes for comparison
### Code directly converted from Davis et al 2020

#####Physician Diagnosed Disorders#####

Full_Data_MHQ2$SRSocPhobia<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
  			   ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 1) |
		                  (!is.na(`20544-0.2`) & `20544-0.2` == 1) |
		                  (!is.na(`20544-0.3`) & `20544-0.3` == 1) |
		                  (!is.na(`20544-0.4`) & `20544-0.4` == 1) |
		                  (!is.na(`20544-0.5`) & `20544-0.5` == 1) |
		                  (!is.na(`20544-0.6`) & `20544-0.6` == 1) |
		                  (!is.na(`20544-0.7`) & `20544-0.7` == 1) |
		                  (!is.na(`20544-0.8`) & `20544-0.8` == 1) |
		                  (!is.na(`20544-0.9`) & `20544-0.9` == 1) |
		                  (!is.na(`20544-0.10`) & `20544-0.10` == 1) |
		                  (!is.na(`20544-0.11`) & `20544-0.11` == 1) |
		                  (!is.na(`20544-0.12`) & `20544-0.12` == 1) |
		                  (!is.na(`20544-0.13`) & `20544-0.13` == 1) |
		                  (!is.na(`20544-0.14`) & `20544-0.14` == 1) |
		                  (!is.na(`20544-0.15`) & `20544-0.15` == 1) |
		                  (!is.na(`20544-0.16`) & `20544-0.16` == 1), 1, 0)))

Full_Data_MHQ2$SRSchizophrenia<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
			       ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 2) |
		                      (!is.na(`20544-0.2`) & `20544-0.2` == 2) |
		                      (!is.na(`20544-0.3`) & `20544-0.3` == 2) |
		                      (!is.na(`20544-0.4`) & `20544-0.4` == 2) |
		                      (!is.na(`20544-0.5`) & `20544-0.5` == 2) |
		                      (!is.na(`20544-0.6`) & `20544-0.6` == 2) |
		                      (!is.na(`20544-0.7`) & `20544-0.7` == 2) |
		                      (!is.na(`20544-0.8`) & `20544-0.8` == 2) |
		                      (!is.na(`20544-0.9`) & `20544-0.9` == 2) |
		                      (!is.na(`20544-0.10`) & `20544-0.10` == 2) |
		                      (!is.na(`20544-0.11`) & `20544-0.11` == 2) |
		                      (!is.na(`20544-0.12`) & `20544-0.12` == 2) |
		                      (!is.na(`20544-0.13`) & `20544-0.13` == 2) |
		                      (!is.na(`20544-0.14`) & `20544-0.14` == 2) |
		                      (!is.na(`20544-0.15`) & `20544-0.15` == 2) |
		                      (!is.na(`20544-0.16`) & `20544-0.16` == 2), 1, 0)))

Full_Data_MHQ2$SRPsychosisOther<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
			        ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 3) |
		                       (!is.na(`20544-0.2`) & `20544-0.2` == 3) |
		                       (!is.na(`20544-0.3`) & `20544-0.3` == 3) |
		                       (!is.na(`20544-0.4`) & `20544-0.4` == 3) |
		                       (!is.na(`20544-0.5`) & `20544-0.5` == 3) |
		                       (!is.na(`20544-0.6`) & `20544-0.6` == 3) |
		                       (!is.na(`20544-0.7`) & `20544-0.7` == 3) |
		                       (!is.na(`20544-0.8`) & `20544-0.8` == 3) |
		                       (!is.na(`20544-0.9`) & `20544-0.9` == 3) |
		                       (!is.na(`20544-0.10`) & `20544-0.10` == 3) |
		                       (!is.na(`20544-0.11`) & `20544-0.11` == 3) |
		                       (!is.na(`20544-0.12`) & `20544-0.12` == 3) |
		                       (!is.na(`20544-0.13`) & `20544-0.13` == 3) |
		                       (!is.na(`20544-0.14`) & `20544-0.14` == 3) |
		                       (!is.na(`20544-0.15`) & `20544-0.15` == 3) |
		                       (!is.na(`20544-0.16`) & `20544-0.16` == 3), 1, 0)))

Full_Data_MHQ2$SRPsychosisAny<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA,
					 ifelse((!is.na(SRSchizophrenia) & SRSchizophrenia == 1) | (!is.na(SRPsychosisOther) & SRPsychosisOther == 1), 1, 0)))


Full_Data_MHQ2$SRPersonalityDisorder<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
				     ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 4) |
		                            (!is.na(`20544-0.2`) & `20544-0.2` == 4) |
		      		            (!is.na(`20544-0.3`) & `20544-0.3` == 4) |
		      		            (!is.na(`20544-0.4`) & `20544-0.4` == 4) |
		      		            (!is.na(`20544-0.5`) & `20544-0.5` == 4) |
		      		            (!is.na(`20544-0.6`) & `20544-0.6` == 4) |
		      		            (!is.na(`20544-0.7`) & `20544-0.7` == 4) |
		      		            (!is.na(`20544-0.8`) & `20544-0.8` == 4) |
		      		            (!is.na(`20544-0.9`) & `20544-0.9` == 4) |
		      		            (!is.na(`20544-0.10`) & `20544-0.10` == 4) |
		      		            (!is.na(`20544-0.11`) & `20544-0.11` == 4) |
		      		            (!is.na(`20544-0.12`) & `20544-0.12` == 4) |
		      		            (!is.na(`20544-0.13`) & `20544-0.13` == 4) |
		      		            (!is.na(`20544-0.14`) & `20544-0.14` == 4) |
		      		            (!is.na(`20544-0.15`) & `20544-0.15` == 4) |
		      		            (!is.na(`20544-0.16`) & `20544-0.16` == 4), 1, 0)))

Full_Data_MHQ2$SROtherPhobia<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
			     ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 5) |
		      	            (!is.na(`20544-0.2`) & `20544-0.2` == 5) |
		      	            (!is.na(`20544-0.3`) & `20544-0.3` == 5) |
		      	            (!is.na(`20544-0.4`) & `20544-0.4` == 5) |
		    	            (!is.na(`20544-0.5`) & `20544-0.5` == 5) |
		      	            (!is.na(`20544-0.6`) & `20544-0.6` == 5) |
		      	            (!is.na(`20544-0.7`) & `20544-0.7` == 5) |
		      	            (!is.na(`20544-0.8`) & `20544-0.8` == 5) |
		      	            (!is.na(`20544-0.9`) & `20544-0.9` == 5) |
		      	            (!is.na(`20544-0.10`) & `20544-0.10` == 5) |
		      	            (!is.na(`20544-0.11`) & `20544-0.11` == 5) |
		      	            (!is.na(`20544-0.12`) & `20544-0.12` == 5) |
		      	            (!is.na(`20544-0.13`) & `20544-0.13` == 5) |
		      	            (!is.na(`20544-0.14`) & `20544-0.14` == 5) |
		      	            (!is.na(`20544-0.15`) & `20544-0.15` == 5) |
		      	            (!is.na(`20544-0.16`) & `20544-0.16` == 5), 1, 0)))

Full_Data_MHQ2$SRPanicAttacks<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
			      ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 6) |
		                     (!is.na(`20544-0.2`) & `20544-0.2` == 6) |
		                     (!is.na(`20544-0.3`) & `20544-0.3` == 6) |
		                     (!is.na(`20544-0.4`) & `20544-0.4` == 6) |
		                     (!is.na(`20544-0.5`) & `20544-0.5` == 6) |
		                     (!is.na(`20544-0.6`) & `20544-0.6` == 6) |
		                     (!is.na(`20544-0.7`) & `20544-0.7` == 6) |
		                     (!is.na(`20544-0.8`) & `20544-0.8` == 6) |
		                     (!is.na(`20544-0.9`) & `20544-0.9` == 6) |
		                     (!is.na(`20544-0.10`) & `20544-0.10` == 6) |
		                     (!is.na(`20544-0.11`) & `20544-0.11` == 6) |
		                     (!is.na(`20544-0.12`) & `20544-0.12` == 6) |
		                     (!is.na(`20544-0.13`) & `20544-0.13` == 6) |
		                     (!is.na(`20544-0.14`) & `20544-0.14` == 6) |
		                     (!is.na(`20544-0.15`) & `20544-0.15` == 6) |
		                     (!is.na(`20544-0.16`) & `20544-0.16` == 6), 1, 0)))

Full_Data_MHQ2$SROCD<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
		     ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 7) |
		            (!is.na(`20544-0.2`) & `20544-0.2` == 7) |
		            (!is.na(`20544-0.3`) & `20544-0.3` == 7) |
		            (!is.na(`20544-0.4`) & `20544-0.4` == 7) |
		            (!is.na(`20544-0.5`) & `20544-0.5` == 7) |
		            (!is.na(`20544-0.6`) & `20544-0.6` == 7) |
		            (!is.na(`20544-0.7`) & `20544-0.7` == 7) |
		            (!is.na(`20544-0.8`) & `20544-0.8` == 7) |
		            (!is.na(`20544-0.9`) & `20544-0.9` == 7) |
		            (!is.na(`20544-0.10`) & `20544-0.10` == 7) |
		            (!is.na(`20544-0.11`) & `20544-0.11` == 7) |
		            (!is.na(`20544-0.12`) & `20544-0.12` == 7) |
		            (!is.na(`20544-0.13`) & `20544-0.13` == 7) |
		            (!is.na(`20544-0.14`) & `20544-0.14` == 7) |
		            (!is.na(`20544-0.15`) & `20544-0.15` == 7) |
		            (!is.na(`20544-0.16`) & `20544-0.16` == 7), 1, 0)))

Full_Data_MHQ2$SRManiaBIP<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
			  ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 10) |
		                 (!is.na(`20544-0.2`) & `20544-0.2` == 10) |
		                 (!is.na(`20544-0.3`) & `20544-0.3` == 10) |
		                 (!is.na(`20544-0.4`) & `20544-0.4` == 10) |
		                 (!is.na(`20544-0.5`) & `20544-0.5` == 10) |
		                 (!is.na(`20544-0.6`) & `20544-0.6` == 10) |
		                 (!is.na(`20544-0.7`) & `20544-0.7` == 10) |
		                 (!is.na(`20544-0.8`) & `20544-0.8` == 10) |
		                 (!is.na(`20544-0.9`) & `20544-0.9` == 10) |
		                 (!is.na(`20544-0.10`) & `20544-0.10` == 10) |
		                 (!is.na(`20544-0.11`) & `20544-0.11` == 10) |
		                 (!is.na(`20544-0.12`) & `20544-0.12` == 10) |
		                 (!is.na(`20544-0.13`) & `20544-0.13` == 10) |
		                 (!is.na(`20544-0.14`) & `20544-0.14` == 10) |
		                 (!is.na(`20544-0.15`) & `20544-0.15` == 10) |
		                 (!is.na(`20544-0.16`) & `20544-0.16` == 10), 1, 0)))

Full_Data_MHQ2$SRDepression<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
			    ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 11) |
		                   (!is.na(`20544-0.2`) & `20544-0.2` == 11) |
		                   (!is.na(`20544-0.3`) & `20544-0.3` == 11) |
		                   (!is.na(`20544-0.4`) & `20544-0.4` == 11) |
		                   (!is.na(`20544-0.5`) & `20544-0.5` == 11) |
		                   (!is.na(`20544-0.6`) & `20544-0.6` == 11) |
		                   (!is.na(`20544-0.7`) & `20544-0.7` == 11) |
		                   (!is.na(`20544-0.8`) & `20544-0.8` == 11) |
		                   (!is.na(`20544-0.9`) & `20544-0.9` == 11) |
		                   (!is.na(`20544-0.10`) & `20544-0.10` == 11) |
		                   (!is.na(`20544-0.11`) & `20544-0.11` == 11) |
		                   (!is.na(`20544-0.12`) & `20544-0.12` == 11) |
		                   (!is.na(`20544-0.13`) & `20544-0.13` == 11) |
		                   (!is.na(`20544-0.14`) & `20544-0.14` == 11) |
		                   (!is.na(`20544-0.15`) & `20544-0.15` == 11) |
		                   (!is.na(`20544-0.16`) & `20544-0.16` == 11), 1, 0)))

Full_Data_MHQ2$SRMood<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA,
		      ifelse(!is.na(SRManiaBIP) & SRManiaBIP == 1 |
		      	     !is.na(SRDepression) & SRDepression == 1, 1, 0)))

Full_Data_MHQ2$SRBulimiaNervosa<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
			        ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 12) |
		                       (!is.na(`20544-0.2`) & `20544-0.2` == 12) |
		                       (!is.na(`20544-0.3`) & `20544-0.3` == 12) |
		                       (!is.na(`20544-0.4`) & `20544-0.4` == 12) |
		                       (!is.na(`20544-0.5`) & `20544-0.5` == 12) |
		                       (!is.na(`20544-0.6`) & `20544-0.6` == 12) |
		                       (!is.na(`20544-0.7`) & `20544-0.7` == 12) |
		                       (!is.na(`20544-0.8`) & `20544-0.8` == 12) |
		                       (!is.na(`20544-0.9`) & `20544-0.9` == 12) |
		                       (!is.na(`20544-0.10`) & `20544-0.10` == 12) |
		                       (!is.na(`20544-0.11`) & `20544-0.11` == 12) |
		                       (!is.na(`20544-0.12`) & `20544-0.12` == 12) |
		                       (!is.na(`20544-0.13`) & `20544-0.13` == 12) |
		                       (!is.na(`20544-0.14`) & `20544-0.14` == 12) |
		                       (!is.na(`20544-0.15`) & `20544-0.15` == 12) |
		                       (!is.na(`20544-0.16`) & `20544-0.16` == 12), 1, 0)))

Full_Data_MHQ2$SRBingeEating<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
			     ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 13) |
		                    (!is.na(`20544-0.2`) & `20544-0.2` == 13) |
		                    (!is.na(`20544-0.3`) & `20544-0.3` == 13) |
		                    (!is.na(`20544-0.4`) & `20544-0.4` == 13) |
		                    (!is.na(`20544-0.5`) & `20544-0.5` == 13) |
		                    (!is.na(`20544-0.6`) & `20544-0.6` == 13) |
		                    (!is.na(`20544-0.7`) & `20544-0.7` == 13) |
		                    (!is.na(`20544-0.8`) & `20544-0.8` == 13) |
		                    (!is.na(`20544-0.9`) & `20544-0.9` == 13) |
		                    (!is.na(`20544-0.10`) & `20544-0.10` == 13) |
		                    (!is.na(`20544-0.11`) & `20544-0.11` == 13) |
		                    (!is.na(`20544-0.12`) & `20544-0.12` == 13) |
		                    (!is.na(`20544-0.13`) & `20544-0.13` == 13) |
		                    (!is.na(`20544-0.14`) & `20544-0.14` == 13) |
		                    (!is.na(`20544-0.15`) & `20544-0.15` == 13) |
		                    (!is.na(`20544-0.16`) & `20544-0.16` == 13), 1, 0)))

Full_Data_MHQ2$SRASD<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
		     ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 14) |
		            (!is.na(`20544-0.2`) & `20544-0.2` == 14) |
		            (!is.na(`20544-0.3`) & `20544-0.3` == 14) |
		            (!is.na(`20544-0.4`) & `20544-0.4` == 14) |
		            (!is.na(`20544-0.5`) & `20544-0.5` == 14) |
		            (!is.na(`20544-0.6`) & `20544-0.6` == 14) |
		            (!is.na(`20544-0.7`) & `20544-0.7` == 14) |
		            (!is.na(`20544-0.8`) & `20544-0.8` == 14) |
		            (!is.na(`20544-0.9`) & `20544-0.9` == 14) |
		            (!is.na(`20544-0.10`) & `20544-0.10` == 14) |
		            (!is.na(`20544-0.11`) & `20544-0.11` == 14) |
		            (!is.na(`20544-0.12`) & `20544-0.12` == 14) |
		            (!is.na(`20544-0.13`) & `20544-0.13` == 14) |
		            (!is.na(`20544-0.14`) & `20544-0.14` == 14) |
		            (!is.na(`20544-0.15`) & `20544-0.15` == 14) |
		            (!is.na(`20544-0.16`) & `20544-0.16` == 14), 1, 0)))

Full_Data_MHQ2$SRGADandOthers<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
			      ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 15) |
		                     (!is.na(`20544-0.2`) & `20544-0.2` == 15) |
		                     (!is.na(`20544-0.3`) & `20544-0.3` == 15) |
		                     (!is.na(`20544-0.4`) & `20544-0.4` == 15) |
		                     (!is.na(`20544-0.5`) & `20544-0.5` == 15) |
		                     (!is.na(`20544-0.6`) & `20544-0.6` == 15) |
		                     (!is.na(`20544-0.7`) & `20544-0.7` == 15) |
		                     (!is.na(`20544-0.8`) & `20544-0.8` == 15) |
		                     (!is.na(`20544-0.9`) & `20544-0.9` == 15) |
		                     (!is.na(`20544-0.10`) & `20544-0.10` == 15) |
		                     (!is.na(`20544-0.11`) & `20544-0.11` == 15) |
		                     (!is.na(`20544-0.12`) & `20544-0.12` == 15) |
		                     (!is.na(`20544-0.13`) & `20544-0.13` == 15) |
		                     (!is.na(`20544-0.14`) & `20544-0.14` == 15) |
		                     (!is.na(`20544-0.15`) & `20544-0.15` == 15) |
		                     (!is.na(`20544-0.16`) & `20544-0.16` == 15), 1, 0)))

Full_Data_MHQ2$SRAnorexiaNervosa<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
			         ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 16) |
		                        (!is.na(`20544-0.2`) & `20544-0.2` == 16) |
		                        (!is.na(`20544-0.3`) & `20544-0.3` == 16) |
		                        (!is.na(`20544-0.4`) & `20544-0.4` == 16) |
		                        (!is.na(`20544-0.5`) & `20544-0.5` == 16) |
		                        (!is.na(`20544-0.6`) & `20544-0.6` == 16) |
		                        (!is.na(`20544-0.7`) & `20544-0.7` == 16) |
		                        (!is.na(`20544-0.8`) & `20544-0.8` == 16) |
		                        (!is.na(`20544-0.9`) & `20544-0.9` == 16) |
		                        (!is.na(`20544-0.10`) & `20544-0.10` == 16) |
		                        (!is.na(`20544-0.11`) & `20544-0.11` == 16) |
		                        (!is.na(`20544-0.12`) & `20544-0.12` == 16) |
		                        (!is.na(`20544-0.13`) & `20544-0.13` == 16) |
		                        (!is.na(`20544-0.14`) & `20544-0.14` == 16) |
		                        (!is.na(`20544-0.15`) & `20544-0.15` == 16) |
		                        (!is.na(`20544-0.16`) & `20544-0.16` == 16), 1, 0)))

Full_Data_MHQ2$SREatingDisorderAny<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA,
				   ifelse((!is.na(SRAnorexiaNervosa) & SRAnorexiaNervosa == 1) | 
			         	  (!is.na(SRBulimiaNervosa) & SRBulimiaNervosa == 1) |
			         	  (!is.na(SRBingeEating) & SRBingeEating == 1), 1, 0)))

Full_Data_MHQ2$SRAgoraphobia<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
			     ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 17) |
		                    (!is.na(`20544-0.2`) & `20544-0.2` == 17) |
		                    (!is.na(`20544-0.3`) & `20544-0.3` == 17) |
		                    (!is.na(`20544-0.4`) & `20544-0.4` == 17) |
		                    (!is.na(`20544-0.5`) & `20544-0.5` == 17) |
		                    (!is.na(`20544-0.6`) & `20544-0.6` == 17) |
		                    (!is.na(`20544-0.7`) & `20544-0.7` == 17) |
		                    (!is.na(`20544-0.8`) & `20544-0.8` == 17) |
		                    (!is.na(`20544-0.9`) & `20544-0.9` == 17) |
		                    (!is.na(`20544-0.10`) & `20544-0.10` == 17) |
		                    (!is.na(`20544-0.11`) & `20544-0.11` == 17) |
		                    (!is.na(`20544-0.12`) & `20544-0.12` == 17) |
		                    (!is.na(`20544-0.13`) & `20544-0.13` == 17) |
		                    (!is.na(`20544-0.14`) & `20544-0.14` == 17) |
		                    (!is.na(`20544-0.15`) & `20544-0.15` == 17) |
		                    (!is.na(`20544-0.16`) & `20544-0.16` == 17), 1, 0)))

Full_Data_MHQ2$SRAnxietyAny<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA,
			    ifelse((!is.na(SRSocPhobia) & SRSocPhobia == 1) | 
			           (!is.na(SRGADandOthers) & SRGADandOthers == 1) |
			           (!is.na(SRPanicAttacks) & SRPanicAttacks == 1) |
			           (!is.na(SRAgoraphobia) & SRAgoraphobia == 1) |
			           (!is.na(SROtherPhobia) & SROtherPhobia == 1) |
			           (!is.na(SROCD) & SROCD == 1), 1, 0)))

Full_Data_MHQ2$SRADHD<-with(Full_Data_MHQ2, ifelse(is.na(`20499-0.0`), NA, 
		      ifelse((!is.na(`20544-0.1`) & `20544-0.1` == 18) |
		             (!is.na(`20544-0.2`) & `20544-0.2` == 18) |
		             (!is.na(`20544-0.3`) & `20544-0.3` == 18) |
		             (!is.na(`20544-0.4`) & `20544-0.4` == 18) |
		             (!is.na(`20544-0.5`) & `20544-0.5` == 18) |
		             (!is.na(`20544-0.6`) & `20544-0.6` == 18) |
		             (!is.na(`20544-0.7`) & `20544-0.7` == 18) |
		             (!is.na(`20544-0.8`) & `20544-0.8` == 18) |
		             (!is.na(`20544-0.9`) & `20544-0.9` == 18) |
		             (!is.na(`20544-0.10`) & `20544-0.10` == 18) |
		             (!is.na(`20544-0.11`) & `20544-0.11` == 18) |
		             (!is.na(`20544-0.12`) & `20544-0.12` == 18) |
		             (!is.na(`20544-0.13`) & `20544-0.13` == 18) |
		             (!is.na(`20544-0.14`) & `20544-0.14` == 18) |
		             (!is.na(`20544-0.15`) & `20544-0.15` == 18) |
		             (!is.na(`20544-0.16`) & `20544-0.16` == 18), 1, 0)))


#####Interview Diagnoses At Baseline######

InterviewDepression<-apply(Full_Data_MHQ2[,grep("`20002.0", colnames(Full_Data_MHQ2))], 1, function(row) "1286" %in% row)

Full_Data_MHQ2$InterviewDepression[c(InterviewDepression)]<-1

####HES Inpatient Diagnoses######

ICDFields<-c("F300","F308","F311","F314","F317","F320","F323","F32","F332","F338","F341","F380","F39","F301","F309","F312","F315","F318","F321","F328","F330","F333","F339","F348","F381","F302","F310","F313","F316","F319","F322","F329","F331","F334","F340","F349","F388")


HESMood<-apply(Full_Data_MHQ2[,grep("f.4120", colnames(Full_Data_MHQ2))], 1, function(row) ICDFields %in% row)

HESMood_Combined<-numeric()

for(indiv in 1:dim(Full_Data_MHQ2)[1]){
    HESMood_Combined[indiv]<-ifelse(sum(HESMood[(((indiv-1)*length(ICDFields))+1):(indiv*length(ICDFields))]) == 0, 0, 1)
}

Full_Data_MHQ2$HESMood[c(HESMood_Combined==1)]<-1

#####Drug-derived Diagnoses######

## List of codes for antidepressants

antidepcodes<-c("1140879616","1140921600","1140879540","1140867878","1140916282","1140909806","1140867888","1141152732","1141180212","1140879634","1140867876","1140882236",
                "1141190158","1141200564","1140867726","1140879620","1140867818","1140879630","1140879628","1141151946","1140867948","1140867624","1140867756","1140867884",
                "1141151978","1141152736","1141201834","1140867690","1140867640","1140867920","1140867850","1140879544","1141200570","1140867934","1140867758","1140867914",
                "1140867820","1141151982","1140882244","1140879556","1140867852","1140867860","1140917460","1140867938","1140867856","1140867922","1140910820","1140882312",
                "1140867944","1140867784","1140867812","1140867668","1140867940")

DrugDepression<-apply(Full_Data_MHQ2[,grep("`20003.0", colnames(Full_Data_MHQ2))], 1, function(row) antidepcodes %in% row)

DrugDepression_Combined<-numeric()

for(indiv in 1:dim(Full_Data_MHQ2)[1]){
    DrugDepression_Combined[indiv]<-ifelse(sum(DrugDepression[(((indiv-1)*length(antidepcodes))+1):(indiv*length(antidepcodes))]) == 0, 0, 1)
}

Full_Data_MHQ2$DrugDepression[DrugDepression_Combined==1]<-1

###Smith Depression Diagnosis 2013

Full_Data_MHQ2$SmithDepression<-with(Full_Data_MHQ2, ifelse(is.na(`20126-0.0`), NA,
			       ifelse(!is.na(`20126-0.0`) & `20126-0.0` > 2, 1, 0)))

#####Depression######

#####Recent depression: PHQ-9######

Full_Data_MHQ2$PHQ9.No.Info<-with(Full_Data_MHQ2,ifelse((is.na(`20514-0.0`) | `20514-0.0` < 0) &
                                  (is.na(`20510-0.0`) | `20510-0.0` < 0),1,0))

Full_Data_MHQ2$PHQ9.Screen<-with(Full_Data_MHQ2,ifelse(((!is.na(`20514-0.0`) & `20514-0.0` >= 2) |
				  (!is.na(`20510-0.0`) & `20510-0.0` >= 2)) &
				 (!is.na(PHQ9.No.Info) & PHQ9.No.Info == 0),1,0))
Full_Data_MHQ2$PHQ9.Items<-0

Full_Data_MHQ2$PHQ9.Items<-with(Full_Data_MHQ2, ifelse(!is.na(`20514-0.0`) & `20514-0.0` >= 3, PHQ9.Items + 1, PHQ9.Items))
Full_Data_MHQ2$PHQ9.Items<-with(Full_Data_MHQ2, ifelse(!is.na(`20507-0.0`) & `20507-0.0` >= 3, PHQ9.Items + 1, PHQ9.Items))
Full_Data_MHQ2$PHQ9.Items<-with(Full_Data_MHQ2, ifelse(!is.na(`20510-0.0`) & `20510-0.0` >= 3, PHQ9.Items + 1, PHQ9.Items))
Full_Data_MHQ2$PHQ9.Items<-with(Full_Data_MHQ2, ifelse(!is.na(`20508-0.0`) & `20508-0.0` >= 3, PHQ9.Items + 1, PHQ9.Items))
Full_Data_MHQ2$PHQ9.Items<-with(Full_Data_MHQ2, ifelse(!is.na(`20517-0.0`) & `20517-0.0` >= 3, PHQ9.Items + 1, PHQ9.Items))
Full_Data_MHQ2$PHQ9.Items<-with(Full_Data_MHQ2, ifelse(!is.na(`20518-0.0`) & `20518-0.0` >= 3, PHQ9.Items + 1, PHQ9.Items))
Full_Data_MHQ2$PHQ9.Items<-with(Full_Data_MHQ2, ifelse(!is.na(`20519-0.0`) & `20519-0.0` >= 3, PHQ9.Items + 1, PHQ9.Items))
Full_Data_MHQ2$PHQ9.Items<-with(Full_Data_MHQ2, ifelse(!is.na(`20511-0.0`) & `20511-0.0` >= 3, PHQ9.Items + 1, PHQ9.Items))
Full_Data_MHQ2$PHQ9.Items<-with(Full_Data_MHQ2, ifelse(!is.na(`20513-0.0`) & `20513-0.0` >= 2, PHQ9.Items + 1, PHQ9.Items))


Full_Data_MHQ2$PHQ9.Severity<-with(Full_Data_MHQ2, ifelse(`20514-0.0` < 0 | is.na(`20514-0.0`), 0, as.numeric(`20514-0.0`)-1) +
			     ifelse(`20507-0.0` < 0 | is.na(`20507-0.0`), 0, as.numeric(`20507-0.0`)-1) +
			     ifelse(`20510-0.0` < 0 | is.na(`20510-0.0`), 0, as.numeric(`20510-0.0`)-1) +
			     ifelse(`20508-0.0` < 0 | is.na(`20508-0.0`), 0, as.numeric(`20508-0.0`)-1) +
			     ifelse(`20517-0.0` < 0 | is.na(`20517-0.0`), 0, as.numeric(`20517-0.0`)-1) +
			     ifelse(`20518-0.0` < 0 | is.na(`20518-0.0`), 0, as.numeric(`20518-0.0`)-1) +
			     ifelse(`20519-0.0` < 0 | is.na(`20519-0.0`), 0, as.numeric(`20519-0.0`)-1) +
			     ifelse(`20513-0.0` < 0 | is.na(`20513-0.0`), 0, as.numeric(`20513-0.0`)-1) +
			     ifelse(`20511-0.0` < 0 | is.na(`20511-0.0`), 0, as.numeric(`20511-0.0`)-1))

#####Lifetime depression:  CIDI-MDD######

Full_Data_MHQ2$CIDI.MDD.No.Info<-with(Full_Data_MHQ2,ifelse(((is.na(`20446-0.0`) | `20446-0.0` < 0) &
				       (is.na(`20441-0.0`) | `20441-0.0` < 0 )), 1, 0))

Full_Data_MHQ2$CIDI.MDD.Screen<-with(Full_Data_MHQ2,ifelse(((!is.na(`20446-0.0`) & `20446-0.0` == 1) |
			              (!is.na(`20441-0.0`) & `20441-0.0` == 1)) &
				     (!is.na(`20436-0.0`) & `20436-0.0` > 2) &
				     (!is.na(`20439-0.0`) & `20439-0.0` > 1) &
				     (!is.na(`20440-0.0`) & `20440-0.0` > 1), 1, 0))

Full_Data_MHQ2$CIDI.MDD.Response<-0

Full_Data_MHQ2$CIDI.MDD.Response<-with(Full_Data_MHQ2, ifelse(!is.na(`20446-0.0`) & `20446-0.0` > 0, CIDI.MDD.Response + 1, CIDI.MDD.Response))
Full_Data_MHQ2$CIDI.MDD.Response<-with(Full_Data_MHQ2, ifelse(!is.na(`20441-0.0`) & `20441-0.0` > 0, CIDI.MDD.Response + 1, CIDI.MDD.Response))
Full_Data_MHQ2$CIDI.MDD.Response<-with(Full_Data_MHQ2, ifelse(!is.na(`20449-0.0`) & `20449-0.0` > 0, CIDI.MDD.Response + 1, CIDI.MDD.Response))
Full_Data_MHQ2$CIDI.MDD.Response<-with(Full_Data_MHQ2, ifelse(!is.na(`20536-0.0`) & `20536-0.0` > 0, CIDI.MDD.Response + 1, CIDI.MDD.Response))
Full_Data_MHQ2$CIDI.MDD.Response<-with(Full_Data_MHQ2, ifelse(!is.na(`20532-0.0`) & `20532-0.0` > 0, CIDI.MDD.Response + 1, CIDI.MDD.Response))
Full_Data_MHQ2$CIDI.MDD.Response<-with(Full_Data_MHQ2, ifelse(!is.na(`20435-0.0`) & `20435-0.0` > 0, CIDI.MDD.Response + 1, CIDI.MDD.Response))
Full_Data_MHQ2$CIDI.MDD.Response<-with(Full_Data_MHQ2, ifelse(!is.na(`20450-0.0`) & `20450-0.0` > 0, CIDI.MDD.Response + 1, CIDI.MDD.Response))
Full_Data_MHQ2$CIDI.MDD.Response<-with(Full_Data_MHQ2, ifelse(!is.na(`20437-0.0`) & `20437-0.0` > 0, CIDI.MDD.Response + 1, CIDI.MDD.Response))

Full_Data_MHQ2$CIDI.MDD.Severity<-with(Full_Data_MHQ2, ifelse(as.numeric(`20446-0.0`) < 0 | is.na(`20446-0.0`), 0, as.numeric(`20446-0.0`)) +
				 ifelse(as.numeric(`20441-0.0`) < 0 | is.na(`20441-0.0`), 0, as.numeric(`20441-0.0`)) +
				 ifelse(as.numeric(`20449-0.0`) < 0 | is.na(`20449-0.0`), 0, as.numeric(`20449-0.0`)) +
				 ifelse(as.numeric(`20536-0.0`) < 1 | is.na(`20536-0.0`), 0, 1) +
				 ifelse(as.numeric(`20532-0.0`) < 0 | is.na(`20532-0.0`), 0, as.numeric(`20532-0.0`)) +
				 ifelse(as.numeric(`20435-0.0`) < 0 | is.na(`20435-0.0`), 0, as.numeric(`20435-0.0`)) +
				 ifelse(as.numeric(`20450-0.0`) < 0 | is.na(`20450-0.0`), 0, as.numeric(`20450-0.0`)) +
				 ifelse(as.numeric(`20437-0.0`) < 0 | is.na(`20437-0.0`), 0, as.numeric(`20437-0.0`)))

#####Depression Diagnoses#####

### Depressed ever is equivalent to screening for caseness on the CIDI

Full_Data_MHQ2$Depressed.Ever<-with(Full_Data_MHQ2, ifelse(CIDI.MDD.No.Info == 1, NA,
			      ifelse(CIDI.MDD.Screen == 1 & (!is.na(CIDI.MDD.Response) & CIDI.MDD.Response > 4), 1, 
			      ifelse(CIDI.MDD.Screen == 0 & 
			             (!is.na(PHQ9.Severity) & PHQ9.Severity < 5) & 
				     (is.na(SRDepression) | (!is.na(SRDepression) & SRDepression == 0)) &
				     (is.na(InterviewDepression) | (!is.na(InterviewDepression) & InterviewDepression == 0)), 0, NA))))

### Depressed ever severe has all non-core symptoms and "a lot" of impairment on the CIDI

Full_Data_MHQ2$Depressed.Ever.Severe<-with(Full_Data_MHQ2, ifelse(is.na(Depressed.Ever), NA,
				     ifelse(Depressed.Ever == 0, 0,
				     ifelse(Depressed.Ever == 1 &
				           (!is.na(CIDI.MDD.Severity) & CIDI.MDD.Severity == 8) &
					   (!is.na(`20440-0.0`) & `20440-0.0` == 3), 1, 0))))

### Depression current is PHQ9 and CIDI case

Full_Data_MHQ2$Depressed.Current<-with(Full_Data_MHQ2, ifelse(is.na(Depressed.Ever) | PHQ9.No.Info == 1, NA,
				 ifelse(Depressed.Ever == 0 | (!is.na(PHQ9.Severity) & PHQ9.Severity < 5), 0,
				 ifelse(Depressed.Ever == 1 & (!is.na(PHQ9.Screen) & PHQ9.Screen == 1) &
				        (!is.na(PHQ9.Items) & PHQ9.Items > 4), 1, 0))))

### Depression current severe includes severity of PHQ9

Full_Data_MHQ2$Depressed.Current.Severe<-with(Full_Data_MHQ2, ifelse(is.na(Depressed.Ever) | PHQ9.No.Info == 1, NA,
					ifelse(Depressed.Ever == 0 | (!is.na(PHQ9.Severity) & PHQ9.Severity < 5), 0,
					ifelse(Depressed.Ever == 1 & (!is.na(PHQ9.Screen) & PHQ9.Screen == 1) &
					       (!is.na(PHQ9.Items) & PHQ9.Items > 4) & (!is.na(PHQ9.Severity) & PHQ9.Severity > 15), 1, 0))))

### Subthreshold Depression

Full_Data_MHQ2$Subthreshold.Depression<-with(Full_Data_MHQ2, ifelse((is.na(Depressed.Ever) | Depressed.Ever == 0) & 
				              (((!is.na(SRDepression) & SRDepression == 1) | (!is.na(InterviewDepression) & InterviewDepression == 1)) |
					       CIDI.MDD.Screen == 1 |
					       (!is.na(PHQ9.Severity) & PHQ9.Severity > 5)), 1,
				       ifelse(!is.na(Depressed.Ever) & Depressed.Ever == 1, 0, NA)))

### Recurrent depression - if bipolar disorder I, excluded from depression diagnosis below

Full_Data_MHQ2$Recurrent.Depression<-with(Full_Data_MHQ2, ifelse(is.na(Depressed.Ever) | is.na(`20442-0.0`), NA,
				    ifelse(Depressed.Ever == 1 &
				           !is.na(`20442-0.0`) & (`20442-0.0` > 1 | `20442-0.0` == -999), 1, 0)))

Full_Data_MHQ2$Single.Depression<-with(Full_Data_MHQ2, ifelse(is.na(Depressed.Ever) | is.na(`20442-0.0`), NA,
				 ifelse(Depressed.Ever == 1 & Recurrent.Depression == 0, 1, 0)))

#####BPAD#####

### Bipolar Diagnosis as from Smith et al (2013)

Full_Data_MHQ2$SmithBipolar<-with(Full_Data_MHQ2, ifelse(is.na(`20126-0.0`), NA,
			    ifelse(!is.na(`20126-0.0`) & `20126-0.0` < 3 & `20126-0.0` > 0, 1, 0)))

Full_Data_MHQ2$SmithMood<-with(Full_Data_MHQ2, ifelse(is.na(`20126-0.0`), NA,
		       	 ifelse(!is.na(`20126-0.0`) & `20126-0.0` > 0, 1, 0)))

### Possible Type I / Type II

Full_Data_MHQ2$Total.Manifestations<-0

Full_Data_MHQ2$Total.Manifestations<-with(Full_Data_MHQ2, ifelse(!is.na(`20548-0.1`) & `20548-0.1` > 0, Total.Manifestations + 1, Total.Manifestations))
Full_Data_MHQ2$Total.Manifestations<-with(Full_Data_MHQ2, ifelse(!is.na(`20548-0.2`) & `20548-0.2` > 0, Total.Manifestations + 1, Total.Manifestations))
Full_Data_MHQ2$Total.Manifestations<-with(Full_Data_MHQ2, ifelse(!is.na(`20548-0.3`) & `20548-0.3` > 0, Total.Manifestations + 1, Total.Manifestations))
Full_Data_MHQ2$Total.Manifestations<-with(Full_Data_MHQ2, ifelse(!is.na(`20548-0.4`) & `20548-0.4` > 0, Total.Manifestations + 1, Total.Manifestations))
Full_Data_MHQ2$Total.Manifestations<-with(Full_Data_MHQ2, ifelse(!is.na(`20548-0.5`) & `20548-0.5` > 0, Total.Manifestations + 1, Total.Manifestations))
Full_Data_MHQ2$Total.Manifestations<-with(Full_Data_MHQ2, ifelse(!is.na(`20548-0.6`) & `20548-0.6` > 0, Total.Manifestations + 1, Total.Manifestations))
Full_Data_MHQ2$Total.Manifestations<-with(Full_Data_MHQ2, ifelse(!is.na(`20548-0.7`) & `20548-0.7` > 0, Total.Manifestations + 1, Total.Manifestations))
Full_Data_MHQ2$Total.Manifestations<-with(Full_Data_MHQ2, ifelse(!is.na(`20548-0.8`) & `20548-0.8` > 0, Total.Manifestations + 1, Total.Manifestations))

### Wider defined bipolar: mania plus three manifestations, or irritability plus four manifestations, for a week or more

Full_Data_MHQ2$Wider.Bipolar.Definition<-with(Full_Data_MHQ2, ifelse(((is.na(`20501-0.0`) | `20501-0.0` < 0) &
				 	        (is.na(`20502-0.0`) | `20502-0.0` < 0)), NA,
				        ifelse(((`20501-0.0` == 1 &
				       	        Full_Data_MHQ2$Total.Manifestations > 2) |
				               (`20502-0.0` == 1 &
				                Full_Data_MHQ2$Total.Manifestations > 3)) &
				       	      !is.na(`20492-0.0`) & `20492-0.0` == 3, 1, 
				        ifelse((!is.na(SRManiaBIP) & SRManiaBIP == 0) & (is.na(SmithBipolar) | (!is.na(SmithBipolar) & SmithBipolar == 0)), 0, NA))))

### Type I

Full_Data_MHQ2$BPDI<-with(Full_Data_MHQ2, ifelse(is.na(Wider.Bipolar.Definition), NA,
		    ifelse(Wider.Bipolar.Definition == 1 &
			  (!is.na(`20493-0.0`) & `20493-0.0` == 1) &
			  (!is.na(Depressed.Ever) & Depressed.Ever == 1), 1, 0)))

### If BIP Type 1, set depression diagnoses to NA

Full_Data_MHQ2$Recurrent.Depression.With.BPD<-Full_Data_MHQ2$Recurrent.Depression

Full_Data_MHQ2$Recurrent.Depression<-with(Full_Data_MHQ2, ifelse(BPDI == 1, NA, Recurrent.Depression))


Full_Data_MHQ2$Single.Depression.With.BPD<-Full_Data_MHQ2$Single.Depression

Full_Data_MHQ2$Single.Depression<-with(Full_Data_MHQ2, ifelse(BPDI == 1, NA, Single.Depression))

### Type II

Full_Data_MHQ2$BPDII<-with(Full_Data_MHQ2, ifelse(is.na(Wider.Bipolar.Definition), NA,
		     ifelse(Wider.Bipolar.Definition == 1 &
			   (!is.na(`20493-0.0`) & `20493-0.0` == 0) &
			   (!is.na(Depressed.Ever) & Depressed.Ever == 1), 1, 0)))

#####Anxiety#####

###GAD-CIDI - Count of somatic symptoms on CIDI 

Full_Data_MHQ2$GAD.CIDI.Somatic<-with(Full_Data_MHQ2, (!is.na(`20426-0.0`) & `20426-0.0` > 0) +
			       	(!is.na(`20423-0.0`) & `20423-0.0` > 0) +
			       	(!is.na(`20429-0.0`) & `20429-0.0` > 0) +
			       	(!is.na(`20419-0.0`) & `20419-0.0` > 0) +
			       	(!is.na(`20422-0.0`) & `20422-0.0` > 0) +
			       	(!is.na(`20417-0.0`) & `20417-0.0` > 0) +
			       	(!is.na(`20427-0.0`) & `20427-0.0` > 0))

###GAD-7 - Score

Full_Data_MHQ2$GAD7.Severity<-with(Full_Data_MHQ2, ifelse(`20506-0.0` < 0 | is.na(`20506-0.0`), 0, as.numeric(`20506-0.0`)-1) +
			     ifelse(`20509-0.0` < 0 | is.na(`20509-0.0`), 0, as.numeric(`20509-0.0`)-1) +
			     ifelse(`20520-0.0` < 0 | is.na(`20520-0.0`), 0, as.numeric(`20520-0.0`)-1) +
			     ifelse(`20515-0.0` < 0 | is.na(`20515-0.0`), 0, as.numeric(`20515-0.0`)-1) +
			     ifelse(`20516-0.0` < 0 | is.na(`20516-0.0`), 0, as.numeric(`20516-0.0`)-1) +
			     ifelse(`20505-0.0` < 0 | is.na(`20505-0.0`), 0, as.numeric(`20505-0.0`)-1) +
			     ifelse(`20512-0.0` < 0 | is.na(`20512-0.0`), 0, as.numeric(`20512-0.0`)-1))

## Set all missing to NA

Full_Data_MHQ2$GAD7.Severity<-with(Full_Data_MHQ2, ifelse((`20506-0.0` < 0 | is.na(`20506-0.0`)) &
                                    (`20509-0.0` < 0 | is.na(`20509-0.0`)) &
                                    (`20520-0.0` < 0 | is.na(`20520-0.0`)) &
                                    (`20515-0.0` < 0 | is.na(`20515-0.0`)) &
                                    (`20516-0.0` < 0 | is.na(`20516-0.0`)) &
                                    (`20505-0.0` < 0 | is.na(`20505-0.0`)) &
                                    (`20512-0.0` < 0 | is.na(`20512-0.0`)), NA, GAD7.Severity))

###Generalised Anxiety Disorder Ever

Full_Data_MHQ2$GAD.Ever<-with(Full_Data_MHQ2, ifelse((is.na(`20421-0.0`) | `20421-0.0` < 0), NA,
			ifelse((!is.na(`20421-0.0`) & `20421-0.0`  == 0) & 
				GAD7.Severity < 5, 0,
			ifelse((!is.na(`20421-0.0`) & `20421-0.0`  == 1) &
			       (!is.na(`20420-0.0`) & (`20420-0.0` >= 6 | `20420-0.0` == -999)) &
			       (!is.na(`20538-0.0`) & `20538-0.0` == 1) &
			      ((!is.na(`20425-0.0`) & `20425-0.0` == 1) |
			       (!is.na(`20542-0.0`) & `20542-0.0` == 1)) &
			      ((!is.na(`20543-0.0`) & `20543-0.0` == 2) |
			       (!is.na(`20540-0.0`) & `20540-0.0` == 1)) &
			      ((!is.na(`20541-0.0`) & `20541-0.0` == 1) |
			       (!is.na(`20539-0.0`) & `20539-0.0` == 3) |
			       (!is.na(`20537-0.0`) & `20537-0.0` == 3)) &
			       GAD.CIDI.Somatic >= 3 &
			       (!is.na(`20418-0.0`) & `20418-0.0` >= 2), 1, NA))))

###Generalised Anxiety Disorder Current

Full_Data_MHQ2$GAD.Current<-with(Full_Data_MHQ2, ifelse(is.na(GAD.Ever) | is.na(GAD7.Severity), NA,
			   ifelse(GAD.Ever == 1 & GAD7.Severity > 9, 1, 0)))

#####Alcohol#####

### AUDIT Score

Full_Data_MHQ2$AUDIT.Score<-0
Full_Data_MHQ2$AUDIT.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20414-0.0`) | `20414-0.0` < 0, AUDIT.Score, AUDIT.Score + as.numeric(`20414-0.0`)))
Full_Data_MHQ2$AUDIT.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20403-0.0`) | `20403-0.0` < 0, AUDIT.Score, AUDIT.Score + as.numeric(`20403-0.0`) - 1))
Full_Data_MHQ2$AUDIT.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20416-0.0`) | `20416-0.0` < 0, AUDIT.Score, AUDIT.Score + as.numeric(`20416-0.0`) - 1))
Full_Data_MHQ2$AUDIT.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20409-0.0`) | `20409-0.0` < 0, AUDIT.Score, AUDIT.Score + as.numeric(`20409-0.0`) - 1))
Full_Data_MHQ2$AUDIT.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20408-0.0`) | `20408-0.0` < 0, AUDIT.Score, AUDIT.Score + as.numeric(`20408-0.0`) - 1))
Full_Data_MHQ2$AUDIT.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20411-0.0`) | `20411-0.0` < 0, AUDIT.Score, AUDIT.Score + (2*as.numeric(`20411-0.0`))))
Full_Data_MHQ2$AUDIT.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20405-0.0`) | `20405-0.0` < 0, AUDIT.Score, AUDIT.Score + (2*as.numeric(`20405-0.0`))))
Full_Data_MHQ2$AUDIT.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20413-0.0`) | `20413-0.0` < 0, AUDIT.Score, AUDIT.Score + as.numeric(`20413-0.0`) - 1))
Full_Data_MHQ2$AUDIT.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20407-0.0`) | `20407-0.0` < 0, AUDIT.Score, AUDIT.Score + as.numeric(`20407-0.0`) - 1))
Full_Data_MHQ2$AUDIT.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20412-0.0`) | `20412-0.0` < 0, AUDIT.Score, AUDIT.Score + as.numeric(`20412-0.0`) - 1))

### Alcohol Use Disorder

Full_Data_MHQ2$Alcohol.Use.Disorder<-with(Full_Data_MHQ2, ifelse(AUDIT.Score > 7, 1,
				    ifelse(!is.na(`20404-0.0`) & `20404-0.0` == 1, NA, 
				    ifelse((!is.na(`20414-0.0`) & `20414-0.0` == 0) |  
				    	   (!is.na(`20403-0.0`) & `20403-0.0` == 1 &
				    	    !is.na(`20416-0.0`) & `20416-0.0` == 1 &
				    	   (is.na(`2664-0.0`) | 
					    (!is.na(`2664-0.0`) & `2664-0.0` < 0) | 
					    (!is.na(`2664-0.0`) & `2664-0.0` > 3))), 0, NA))))

#####Cannabis#####

Full_Data_MHQ2$Cannabis.Ever<-with(Full_Data_MHQ2, ifelse(is.na(`20453-0.0`) | `20453-0.0` < 0, NA,
			     ifelse(!is.na(`20453-0.0`) & `20453-0.0` > 0, 1, 0)))

Full_Data_MHQ2$Cannabis.Daily<-with(Full_Data_MHQ2, ifelse(is.na(`20454-0.0`), NA,
			      ifelse(!is.na(`20454-0.0`) & `20454-0.0` == 4, 1, 0)))

#####Addictions Screen#####

###Addiction Ever

Full_Data_MHQ2$Addiction.Ever.SelfReport<-with(Full_Data_MHQ2, ifelse(is.na(`20401-0.0`) | `20401-0.0`  < 0, NA, `20401-0.0`))

Full_Data_MHQ2$Addiction.Ever<-with(Full_Data_MHQ2, ifelse((is.na(`20401-0.0`) | `20401-0.0`  < 0) &
			             (is.na(Cannabis.Daily) | Cannabis.Daily < 0), NA, 
			      ifelse(!is.na(`20401-0.0`) & `20401-0.0` == 0 & 
			             AUDIT.Score < 16 & 
				     ((!is.na(Cannabis.Ever) & Cannabis.Ever == 0) | (!is.na(Cannabis.Daily) & Cannabis.Daily == 0)), 0, 
			      ifelse(!is.na(`20401-0.0`) & `20401-0.0` == 1, 1, NA))))

Full_Data_MHQ2$Substance.Addiction.Ever<-with(Full_Data_MHQ2, ifelse((is.na(`20406-0.0`) | `20406-0.0` < 0) &  
				   	       (is.na(`20456-0.0`) | `20456-0.0` < 0) &
				   	       (is.na(`20503-0.0`) | `20503-0.0` < 0), NA, 
				        ifelse(`20406-0.0` == 1 | `20456-0.0` == 1 | `20503-0.0` == 1, 1, 0)))

Full_Data_MHQ2$Alcohol.Dependence.Ever<-with(Full_Data_MHQ2, ifelse((is.na(`20404-0.0`) | `20404-0.0`  < 0), NA, `20404-0.0`))

###Addiction Current

Full_Data_MHQ2$Addiction.Current<-with(Full_Data_MHQ2, ifelse(is.na(Addiction.Ever) |
			                (((is.na(`20415-0.0`) | `20415-0.0` < 0)) &
					 ((is.na(`20504-0.0`) | `20504-0.0` < 0)) &
					 ((is.na(`20457-0.0`) | `20457-0.0` < 0)) &
					 ((is.na(`20432-0.0`) | `20432-0.0` < 0))), NA,
				 ifelse(Addiction.Ever == 1 &
				       ((!is.na(`20415-0.0`) & `20415-0.0` == 1) |
				        (!is.na(`20504-0.0`) & `20504-0.0` == 1) |
					(!is.na(`20457-0.0`) & `20457-0.0` == 1) |
					(!is.na(`20432-0.0`) & `20432-0.0` == 1)), 1, 0)))

#####Unusual Experiences#####

###Unusual.Experience Ever Hallucinations

Full_Data_MHQ2$Unusual.Experience.Ever.Hallucinations<-with(Full_Data_MHQ2, ifelse((is.na(`20471-0.0`) | `20471-0.0` < 0) &
					            	       (is.na(`20463-0.0`) | `20463-0.0` < 0), NA,
					     		ifelse((!is.na(`20471-0.0`) & `20471-0.0` == 1) |
					            	       (!is.na(`20463-0.0`) & `20463-0.0` == 1), 1, 0)))

###Unusual.Experience.Ever.Delusions

Full_Data_MHQ2$Unusual.Experience.Ever.Delusions<-with(Full_Data_MHQ2, ifelse((is.na(`20474-0.0`) | `20474-0.0` < 0) &
					       	   	  (is.na(`20468-0.0`) | `20468-0.0` < 0), NA,
						   ifelse((!is.na(`20474-0.0`) & `20474-0.0` == 1) |
					       	   	  (!is.na(`20468-0.0`) & `20468-0.0` == 1), 1, 0)))

###Unusual.Experience.Ever

Full_Data_MHQ2$Unusual.Experience.Ever<-with(Full_Data_MHQ2, ifelse((!is.na(Unusual.Experience.Ever.Hallucinations) & Unusual.Experience.Ever.Hallucinations == 1) | 
					        (!is.na(Unusual.Experience.Ever.Delusions) & Unusual.Experience.Ever.Delusions == 1), 1, 
					 ifelse(!is.na(SRPsychosisAny) & SRPsychosisAny == 0, 0, NA)))
###Unusual.Experience.Recent

Full_Data_MHQ2$Unusual.Experience.Recent<-with(Full_Data_MHQ2, ifelse((is.na(`20467-0.0`) | `20467-0.0` < 0), NA,
					   ifelse(`20467-0.0` > 1, 1, 0)))

#####Trauma#####

###Trauma Childhood

Full_Data_MHQ2$Trauma.Childhood<-with(Full_Data_MHQ2, ifelse((is.na(`20488-0.0`) | `20488-0.0` < 0) |
				       (is.na(`20487-0.0`) | `20487-0.0` < 0) |
				       (is.na(`20490-0.0`) | `20490-0.0` < 0) |
				       (is.na(`20491-0.0`) | `20491-0.0` < 0) |
				       (is.na(`20489-0.0`) | `20489-0.0` < 0), NA,
				ifelse(`20488-0.0` > 0 |
				       `20487-0.0` > 0 |
				       `20490-0.0` > 0 | 
				       (4-as.numeric(`20491-0.0`)) > 0 |
				       (4-as.numeric(`20489-0.0`)) > 1, 1, 0)))

###Trauma Adult

Full_Data_MHQ2$Trauma.Adult<-with(Full_Data_MHQ2, ifelse((is.na(`20523-0.0`) | `20523-0.0` < 0) |
				   (is.na(`20521-0.0`) | `20521-0.0` < 0) |
				   (is.na(`20524-0.0`) | `20524-0.0` < 0) |
				   (is.na(`20522-0.0`) | `20522-0.0` < 0) |
				   (is.na(`20525-0.0`) | `20525-0.0` < 0), NA,
			    ifelse(`20523-0.0` > 0 |
				   `20521-0.0` > 0 |
				   `20524-0.0` > 0 |
				   (4-as.numeric(`20522-0.0`)) > 1 |
				   (4-as.numeric(`20525-0.0`)) > 0, 1, 0)))

###Trauma Catastrophic

Full_Data_MHQ2$Trauma.Catastrophic<-with(Full_Data_MHQ2, ifelse((is.na(`20527-0.0`) | `20527-0.0` < 0) &
				          (is.na(`20526-0.0`) | `20526-0.0` < 0) &
					  (is.na(`20528-0.0`) | `20528-0.0` < 0) &
					  (is.na(`20529-0.0`) | `20529-0.0` < 0) &
					  (is.na(`20531-0.0`) | `20531-0.0` < 0) &
					  (is.na(`20530-0.0`) | `20530-0.0` < 0), NA,
				   ifelse((!is.na(`20527-0.0`) & `20527-0.0` > 0) |
				          (!is.na(`20526-0.0`) & `20526-0.0` > 0) |
					  (!is.na(`20528-0.0`) & `20528-0.0` > 0) |
					  (!is.na(`20529-0.0`) & `20529-0.0` > 0) |
					  (!is.na(`20531-0.0`) & `20531-0.0` > 0) |
					  (!is.na(`20530-0.0`) & `20530-0.0` > 0), 1, 0)))

#####PTSD#####

###PCL-6 - Trouble concentrating item is borrowed from PHQ9, scored 1-4, compare 1-5 for other items

Full_Data_MHQ2$PCL.Score<-0

Full_Data_MHQ2$PCL.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20497-0.0`) | `20497-0.0` < 0, PCL.Score, as.numeric(`20497-0.0`) + 1 + PCL.Score))
Full_Data_MHQ2$PCL.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20498-0.0`) | `20498-0.0` < 0, PCL.Score, as.numeric(`20498-0.0`) + 1 + PCL.Score))
Full_Data_MHQ2$PCL.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20495-0.0`) | `20495-0.0` < 0, PCL.Score, as.numeric(`20495-0.0`) + 1 + PCL.Score))
Full_Data_MHQ2$PCL.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20496-0.0`) | `20496-0.0` < 0, PCL.Score, as.numeric(`20496-0.0`) + 1 + PCL.Score))
Full_Data_MHQ2$PCL.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20494-0.0`) | `20494-0.0` < 0, PCL.Score, as.numeric(`20494-0.0`) + 1 + PCL.Score))
Full_Data_MHQ2$PCL.Score<-with(Full_Data_MHQ2, ifelse(is.na(`20508-0.0`) | `20508-0.0` < 0, PCL.Score, as.numeric(`20508-0.0`) + PCL.Score))

Full_Data_MHQ2$PTSD<-with(Full_Data_MHQ2, ifelse((is.na(`20497-0.0`) | `20497-0.0` < 0) |
			   (is.na(`20498-0.0`) | `20498-0.0` < 0) |
			   (is.na(`20495-0.0`) | `20495-0.0` < 0) |
			   (is.na(`20508-0.0`) | `20508-0.0` < 0), NA, 
		     ifelse(PCL.Score > 13, 1, 0)))

#####Self-Harm#####

### Self Harm Ever

Full_Data_MHQ2$Self.Harm.Ever<-with(Full_Data_MHQ2, ifelse((is.na(`20480-0.0`) | `20480-0.0` < 0), NA, `20480-0.0`))

### Life Not Worth Living and Suicide Attempt

Full_Data_MHQ2$Not.Worth.Living<-with(Full_Data_MHQ2, ifelse(is.na(`20479-0.0`), NA,
				ifelse(!is.na(`20479-0.0`) & `20479-0.0` > 0, 1, 0)))

Full_Data_MHQ2$Self.Harm.Suicide.Attempt<-with(Full_Data_MHQ2, ifelse((is.na(`20479-0.0`) | `20479-0.0` < 0) |
					        (is.na(`20483-0.0`) | `20483-0.0` < 0), NA,
					 ifelse(`20479-0.0` > 0 &
					        `20483-0.0` == 1, 1, 0)))

#####Wellbeing#####

Full_Data_MHQ2$WellbeingScore<-with(Full_Data_MHQ2, ifelse(is.na(`20458-0.0`) | `20458-0.0` < 0 | is.na(`20459-0.0`) | `20459-0.0` < 0 | is.na(`20460-0.0`) | `20460-0.0` < 0, NA, 
			             ((7-as.numeric(`20458-0.0`)) + (7-as.numeric(`20459-0.0`)) + as.numeric(`20460-0.0`))))
 
#####CombinedSelfReportConditions#####

Full_Data_MHQ2$SRConditionsSum<-0
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRSchizophrenia == 1, SRConditionsSum + 1, SRConditionsSum)) 
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRPsychosisOther == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRDepression == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRManiaBIP == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRGADandOthers == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRPanicAttacks == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRAgoraphobia == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRSocPhobia == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SROtherPhobia == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SROCD == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRPersonalityDisorder == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRAnorexiaNervosa == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRBulimiaNervosa == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRBingeEating == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRASD == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(SRADHD == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(!is.na(Alcohol.Dependence.Ever) & Alcohol.Dependence.Ever == 1, SRConditionsSum + 1, SRConditionsSum))
Full_Data_MHQ2$SRConditionsSum<-with(Full_Data_MHQ2, ifelse(!is.na(Addiction.Ever) & Addiction.Ever == 1, SRConditionsSum + 1, SRConditionsSum))

Full_Data_MHQ2$NoSRConditions<-with(Full_Data_MHQ2,ifelse(SRConditionsSum == 0, 1, 0))

Full_Data_MHQ2$MultipleSRConditions<-with(Full_Data_MHQ2,ifelse(SRConditionsSum > 1, 1, 0))

#####Depression Comorbidity Codes#####

Full_Data_MHQ2$NoComorbidity<-with(Full_Data_MHQ2, ifelse(is.na(Wider.Bipolar.Definition) & is.na(GAD.Ever) & is.na(Alcohol.Use.Disorder) & is.na(Unusual.Experience.Ever), NA,
			     ifelse((!is.na(Wider.Bipolar.Definition) & Wider.Bipolar.Definition == 1) | 
			     	    (!is.na(GAD.Ever) & GAD.Ever == 1) |
				    (!is.na(Alcohol.Use.Disorder) & Alcohol.Use.Disorder == 1) | 
				    (!is.na(Unusual.Experience.Ever) & Unusual.Experience.Ever == 1), 0, 1)))

Full_Data_MHQ2$AnyComorbidity<-with(Full_Data_MHQ2, ifelse(is.na(Wider.Bipolar.Definition) & is.na(GAD.Ever) & is.na(Alcohol.Use.Disorder) & is.na(Unusual.Experience.Ever), NA,
			      ifelse(NoComorbidity == 1, 0, 1)))

Full_Data_MHQ2$MultipleComorbidity<-with(Full_Data_MHQ2, ifelse(is.na(Wider.Bipolar.Definition) & is.na(GAD.Ever) & is.na(Alcohol.Use.Disorder) & is.na(Unusual.Experience.Ever), NA,
				   ifelse(NoComorbidity == 1, 0,
			     	   ifelse(((!is.na(Wider.Bipolar.Definition) & Wider.Bipolar.Definition == 1) & 
			     	    	  ((!is.na(GAD.Ever) & GAD.Ever == 1) |
				           (!is.na(Alcohol.Use.Disorder) & Alcohol.Use.Disorder == 1) | 
				           (!is.na(Unusual.Experience.Ever) & Unusual.Experience.Ever == 1))) | 
					  ((!is.na(GAD.Ever) & GAD.Ever == 1) & 
				          ((!is.na(Alcohol.Use.Disorder) & Alcohol.Use.Disorder == 1) | 
				           (!is.na(Unusual.Experience.Ever) & Unusual.Experience.Ever == 1))) | 
					  ((!is.na(Alcohol.Use.Disorder) & Alcohol.Use.Disorder == 1) & 
					  (!is.na(Unusual.Experience.Ever) & Unusual.Experience.Ever == 1)), 1, 0))))

#####MH Screen######

## Score
## 1 - Case of any kind
## 0 - Not case on any disorder - no to mental distress and professional help, NA on problems diagnosed

Full_Data_MHQ2$MH.Screen<-with(Full_Data_MHQ2, ifelse(((is.na(`20500-0.0`) | `20500-0.0` < 0) |
 			 	 (is.na(`20499-0.0`) | `20499-0.0` < 0)) &
				 (!is.na(`20544-0.1`) & `20544-0.1` < 0), NA,
			 ifelse(`20500-0.0` == 1 |
			        `20499-0.0` == 1 |
				(!is.na(`20544-0.1`) &
				 `20544-0.1` > 0), 1, 0)))

##If case {any} -> case, NOT control

Full_Data_MHQ2$MH.Screen<-with(Full_Data_MHQ2, ifelse((!is.na(Depressed.Ever) & Depressed.Ever == 1) |
				(!is.na(Wider.Bipolar.Definition) & Wider.Bipolar.Definition == 1) |
				(!is.na(GAD.Ever) & GAD.Ever == 1) |
				(!is.na(Addiction.Ever) & Addiction.Ever == 1) |
				(!is.na(Unusual.Experience.Ever) & Unusual.Experience.Ever == 1) |
				(!is.na(PTSD) & PTSD == 1) |
				(!is.na(Self.Harm.Ever) & Self.Harm.Ever == 1), 1, MH.Screen))

Full_Data_MHQ2$MH.Questionnaires<-with(Full_Data_MHQ2, ifelse((!is.na(Depressed.Ever) & Depressed.Ever == 1) |
				 	(!is.na(Wider.Bipolar.Definition) & Wider.Bipolar.Definition == 1) |
					(!is.na(GAD.Ever) & GAD.Ever == 1) |
					(!is.na(Alcohol.Use.Disorder) & Alcohol.Use.Disorder == 1) |
					(!is.na(Unusual.Experience.Ever) & Unusual.Experience.Ever == 1) |
					(!is.na(PTSD) & PTSD == 1) |
					(!is.na(Self.Harm.Ever) & Self.Harm.Ever == 1), 1, 0))

Full_Data_MHQ2$MH.Questionnaires.Short<-with(Full_Data_MHQ2, ifelse((!is.na(Depressed.Ever) & Depressed.Ever == 1) |
				 	      (!is.na(GAD.Ever) & GAD.Ever == 1) |
					      (!is.na(Unusual.Experience.Ever) & Unusual.Experience.Ever == 1) |
					      (!is.na(Addiction.Ever) & Addiction.Ever == 1), 1, 0))

# Table 6 – MHQ1 vs MHQ2 – Current illness by Age

Rows:
N positive (%)
Under 52
52-58
59-65
66-74
75-81
Over 81

Columns
PHQ9 case
GAD7 case
AUDIT harmful case
(Split by sex)
(Split by MHQ1, MHQ2)


# Table 7a – MHQ1 vs MHQ2 - Lifetime syndromes (Not excluding new onset)
# Table 7b – MHQ1 vs MHQ2 - Lifetime syndromes (Excluding new onset)

Rows
Depression
Bipolar
Self-harm
Cannabis
Any SR clinician diagnosis

Columns
Met in both
Met 1 not 2
Met 2 not 1*
Neither Kappa

# Table 8 – Deeper exploration of depression ()

Rows
Sex
Median current age (or 5y bands)
Ave PHQ9 score
Ave GAD7 score
Median age onset
% single episode depression
% recurrent depression
% bipolar affective disorder

Columns
Met criteria in both
Met criteria 1 not 2
Met criteria 2 not 1
Never met criteria
