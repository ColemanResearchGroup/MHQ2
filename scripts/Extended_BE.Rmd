---
title: "UKB MHQ2 Extended binge eating"
author: "Helena Davies"
date: "2023-10-08"
output: html_document
---

*Criteria*
1) Extended binge-eating or overeating phenotype  = Recurrent episodes of excessive overeating or binge eating, regardless of length and context 
2) Extended binge-eating phenotype  = Recurrent episodes of binge eating (i.e. specifically with loss of control), regardless of length and context 

*Written algorithm*
Have you had recurrent episodes of excessive overeating or binge eating (EP6a) = 02 Yes, at least once a week 
Extended eating disorder phenotypes include participants that may not meet the exact diagnostic criteria used for disorder algorithms, and do not represent any clinical entity 

```{r, purl=FALSE}
library("summarytools")
library("dplyr")
library("tidyverse")
```

```{r read in data, purl=FALSE}
MHQ2 <- readRDS("/Users/helenadavies/werk/UKB_MHQ2_algorithms/anon_data/MHQ2_Anonymous.rds")
```

# Check
```{r sanity check}
# Expecting 3,338 for "Yes, at least once a week" (2)
MHQ2 %>%
  freq(`29132-0.0`)

# Loss of control
# Expecting 9,944 for "Occasionally" (2)
# Expecting 900 for "At least once a week for between 1 and 3 months" (1)
# Expecting 3,904 for "At least once a week for at least 3 months" (0)
MHQ2 %>%
  freq(`29135-0.0`)
```


# 1. Extended BE or overeating (i.e., loss of control not specified)
NB: This is called "overeating or binge eating" because the question itself uses the term "binge eating"
```{r extended BE or overeating}
MHQ2 <- MHQ2 %>%
  mutate(extended_BE_or_overeating_algorithm =
           case_when(
             
         # "Have you had recurrent episodes of excessive overeating or binge eating (i.e. eating significantly more than what most people eat in a similar period of time, for example, two hours)?" = "Yes, at least once a week" 
            `29132-0.0` == 2  ~ 1
            # +++ possibly add "occasionally"
            )
  )
```

# 2. Extended BE (i.e., with loss of control)
```{r extended BE (with loss of control}
MHQ2 <- MHQ2 %>%
  mutate(extended_BE_algorithm =
           case_when(
             
           # "Have you had recurrent episodes of excessive overeating or binge eating (i.e. eating significantly more than what most people eat in a similar period of time, for example, two hours)?" = "Yes, at least once a week" 
            `29132-0.0` == 2  &
              # +++ possibly add "occasionally"
              
             # "During your episodes of excessive overeating/binge eating, how often have you felt like you did not have control over your eating (e.g. not being able to stop eating or feeling compelled to eat)?"
           (
             # "At least once a week for at least 3 months'
             `29135-0.0` == 0 |
               
               # "At least once a week for between 1 and 3 months"
               `29135-0.0` == 1 |
               
               # "Occasionally"
               `29135-0.0` == 2 
           ) ~ 1
           )
  )
```
