Full_Data_MHQ2 <- readRDS("../Data_For_Tables_2024_03_15.rds")
names(Full_Data_MHQ2)
with(Full_Data_MHQ2, depression.ever.case, MHQ1.Depressed.Ever)
with(Full_Data_MHQ2, table(depression.ever.case, MHQ1.Depressed.Ever))
names(Full_Data_MHQ2)
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed), ], table(depression.ever.case, MHQ1.Depressed.Ever))
F29034 <- fread("/datasets/ukbiobank/ukb82087/phenotypes/ukb675453.csv", select=c("eid","29034-0.0"))

Full_Data_MHQ2_F29034 <- left_join(Full_Data_MHQ2, F29034)
Full_Data_MHQ2 <- Full_Data_MHQ2_F29034
F29198 <- fread("/datasets/ukbiobank/ukb82087/phenotypes/ukb675453.csv", select=c("eid","29198-0.0"))

Full_Data_MHQ2 <- left_join(Full_Data_MHQ2_F29034,F29198)

Full_Data_MHQ2$f29034.0.0_clean <- ifelse(Full_Data_MHQ2$`29034-0.0` < 0 | is.na(Full_Data_MHQ2$`29034-0.0`), NA, Full_Data_MHQ2$`29034-0.0`)

packages <- c("data.table", "tidyverse", "dplyr",  "Hmisc", "stringi")
lapply(X = packages, FUN = require, character.only = TRUE)
F29034 <- fread("/datasets/ukbiobank/ukb82087/phenotypes/ukb675453.csv", select=c("eid","29034-0.0"))

Full_Data_MHQ2_F29034 <- left_join(Full_Data_MHQ2, F29034)
Full_Data_MHQ2 <- Full_Data_MHQ2_F29034
F29198 <- fread("/datasets/ukbiobank/ukb82087/phenotypes/ukb675453.csv", select=c("eid","29198-0.0"))
Full_Data_MHQ2 <- left_join(Full_Data_MHQ2_F29034,F29198)
Full_Data_MHQ2$f29034.0.0_clean <- ifelse(Full_Data_MHQ2$`29034-0.0` < 0 | is.na(Full_Data_MHQ2$`29034-0.0`), NA, Full_Data_MHQ2$`29034-0.0`)
Full_Data_MHQ2$ApproxDateFirstDepEpisode <- with(Full_Data_MHQ2, case_when(
is.na(Full_Data_MHQ2$`29198-0.0`) | is.na(MHQ2.Age) | is.na(Full_Data_MHQ2$f29034.0.0_clean) ~ NA,
.default=as.Date(as.Date(Full_Data_MHQ2$`29198-0.0`) - as.difftime((MHQ2.Age-Full_Data_MHQ2$f29034.0.0_clean)*365.25, unit="days"))
)
)
Full_Data_MHQ2$IncidentDepression <- with(Full_Data_MHQ2, case_when(
is.na(ApproxDateFirstDepEpisode) ~ NA,
ApproxDateFirstDepEpisode > as.Date("2016-07-13") ~ 1,
.default = 0
)
)
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$], table(depression.ever.case, IncidentDepression, MHQ1.Depressed.Ever, useNA="a"))

with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed),], table(depression.ever.case, IncidentDepression, MHQ1.Depressed.Ever, useNA="a"))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed),], table(depression.ever.case, IncidentDepression, MHQ1.Depressed.Ever, MHQ2.Sex, useNA="a"))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed),], table(depression.ever.case, IncidentDepression, MHQ1.Depressed.Ever, MHQ2.Age.Bands, useNA="a"))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed),], table(MHQ2.Age.Bands, depression.ever.case, IncidentDepression, MHQ1.Depressed.Ever, useNA="a"))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed),], table(MHQ2.Age.Bands, depression.ever.case, MHQ1.Depressed.Ever, useNA="a"))
218+5259+6276+2844+15
119+3039+5060+2949+20
8+230+184+141+1
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], median(MHQ2.Age, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1,], median(MHQ2.Age, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], median(MHQ2.Age, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & is.na(Full_Data_MHQ2$IncidentDepression),], median(MHQ2.Age, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 1,], median(MHQ2.Age, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 0,], median(MHQ2.Age, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], mean(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], sd(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1,], mean(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1,], sd(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], mean(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], sd(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & is.na(Full_Data_MHQ2$IncidentDepression),], mean(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & is.na(Full_Data_MHQ2$IncidentDepression),], sd(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 1,], mean(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 1,], sd(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 0,], mean(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 0,], sd(PHQ9.Severity, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], mean(Gad7Score, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], sd(Gad7Score, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1,], mean(Gad7Score, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1,], sd(Gad7Score, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], mean(Gad7Score, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], sd(Gad7Score, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & is.na(Full_Data_MHQ2$IncidentDepression),], mean(Gad7Score, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & is.na(Full_Data_MHQ2$IncidentDepression),], sd(Gad7Score, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 1,], mean(Gad7Score, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 1,], sd(Gad7Score, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 0,], mean(Gad7Score, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 0,], sd(Gad7Score, na.rm=T))
names(Full_Data_MHQ2)
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], median(f29034.0.0_clean, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1,], median(f29034.0.0_clean, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], median(f29034.0.0_clean, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 1 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 0,], median(f29034.0.0_clean, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & is.na(Full_Data_MHQ2$IncidentDepression),], median(f29034.0.0_clean, na.rm=T))
dim(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & is.na(Full_Data_MHQ2$IncidentDepression),])
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 1,], median(f29034.0.0_clean, na.rm=T))
with(Full_Data_MHQ2[!is.na(Full_Data_MHQ2$MHQ2_Completed) & !is.na(Full_Data_MHQ2$MHQ1.Depressed.Ever) & Full_Data_MHQ2$MHQ1.Depressed.Ever == 0 & !is.na(Full_Data_MHQ2$depression.ever.case) & Full_Data_MHQ2$depression.ever.case == 1 & !is.na(Full_Data_MHQ2$IncidentDepression) & Full_Data_MHQ2$IncidentDepression == 0,], median(f29034.0.0_clean, na.rm=T))
savehistory("RCode_2024_03_26.txt"
savehistory("RCode_2024_03_26.txt")


